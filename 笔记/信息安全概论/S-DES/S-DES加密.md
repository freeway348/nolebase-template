
# S-DES加密过程举例

---

让我们用10位密钥 `1010000010` 和明文 `10101010` 作为例子，逐步演示S-DES的加密过程。

### 1. **密钥生成**

#### 步骤1：生成 `K1` 和 `K2`
首先，从密钥 `1010000010` 开始，按照如下步骤生成两个子密钥 `K1` 和 `K2`。

##### 1.1. **P10 置换**：
使用一个固定的 P10 置换表，将10位密钥重新排列。假设 P10 表如下：

```
P10: 3 5 2 7 4 10 1 9 8 6
```

按照该表置换密钥 `1010000010`，结果为：

```
P10置换结果：10000 11001
```

##### 1.2. **左移（LS-1）**：
将P10置换后的结果分为左右两部分，并分别进行循环左移1位：

```
左部分：10000 → 00001
右部分：11001 → 10011
```

##### 1.3. **P8 置换**：
将左移后的结果再次进行 P8 置换。假设 P8 表如下：

```
P8: 6 3 7 4 8 5 10 9
```

将 `00001 10011` 经过 P8 置换后，得到第一个子密钥 `K1`：

```
P8置换结果：10100100
```

##### 1.4. **生成 `K2`**：
对 LS-1 之后的左右两部分再进行循环左移2位：

```
左部分：00001 → 00100
右部分：10011 → 01110
```

对左移后的结果再进行 P8 置换，得到第二个子密钥 `K2`：

```
P8置换结果：01000011
```

所以，子密钥 `K1` 和 `K2` 分别为：
- `K1 = 10100100`
- `K2 = 01000011`

### 2. **初始置换 (IP)**
对明文 `10101010` 进行初始置换，假设 IP 表如下：

```
IP: 2 6 3 1 4 8 5 7
```

使用 IP 表对明文 `10101010` 进行置换，结果为：

```
IP 置换结果：01100011
```

将结果分为左右两部分：`L0 = 0110`，`R0 = 0011`。

### 3. **第一轮加密**

在第一轮加密中，我们使用子密钥 `K1 = 10100100`。

#### 步骤 3.1: **扩展置换 (E/P)**

将右半部分 `R0 = 0011` 扩展成8位。假设 E/P 表如下：

```
E/P: 4 1 2 3 2 3 4 1
```

将 `0011` 经过扩展置换（根据扩展E/P表进行扩展并置换，根据E/P表将R0数据按位置写入置换）变为：

```
E/P 结果：10010110
```

#### 步骤 3.2: **与 `K1` 异或**

将扩展置换后的结果与子密钥 `K1 = 10100100` 进行异或操作：

```
10010110 XOR 10100100 = 00110010
```

#### 步骤 3.3: **S盒代换**

将 `00110010` 分成两部分：`0011` 和 `0010`。分别送入两个S盒进行代换。

##### S盒1 (S1):
假设 S1 表如下：

|        | 00   | 01   | 10   | 11   |
|--------|------|------|------|------|
| **00** | 01   | 00   | 11   | 10   |
| **01** | 11   | 10   | 01   | 00   |
| **10** | 00   | 10   | 01   | 11   |
| **11** | 11   | 01   | 11   | 10   |

`0011` 中，行 = `11`，列 = `01`，查表得到 S1 输出为 `01`。

##### S盒2 (S2):
假设 S2 表如下：

|        | 00   | 01   | 10   | 11   |
|--------|------|------|------|------|
| **00** | 00   | 01   | 10   | 11   |
| **01** | 10   | 00   | 01   | 11   |
| **10** | 11   | 01   | 00   | 10   |
| **11** | 01   | 10   | 00   | 11   |

`0010` 中，行 = `00`，列 = `10`，查表得到 S2 输出为 `10`。

所以 S盒代换的输出是 `0110`。

#### 步骤 3.4: **P4 置换**

将 S盒的输出 `0110` 进行 P4 置换。假设 P4 表如下：

```
P4: 2 4 3 1
```

将 `0110` 置换为 `1010`。

#### 步骤 3.5: **与 L0 异或**

将 P4 置换的结果与 L0 = `0110` 进行异或操作：

```
1010 XOR 0110 = 1100
```

得到 `L1 = 1100`，而 R1 保持为 `0011`。

#### 步骤 3.6: **左右交换**

交换左右两部分，得到：

```
L1 = 0011, R1 = 1100
```

### 4. **第二轮加密**

在第二轮加密中，我们使用子密钥 `K2 = 01000011`。

#### 步骤 4.1: **扩展置换 (E/P)**

将 `R1 = 1100` 进行扩展置换：

```
扩展置换结果：01101001
```

#### 步骤 4.2: **与 `K2` 异或**

将扩展置换后的结果与 `K2 = 01000011` 进行异或操作：

```
01101001 XOR 01000011 = 00101010
```

#### 步骤 4.3: **S盒代换**

将 `00101010` 分为两部分：`0010` 和 `1010`。

##### S盒1 代换：
`0010` 对应 S1 表的行 `00` 和列 `10`，查表得到 `10`。

##### S盒2 代换：
`1010` 对应 S2 表的行 `10` 和列 `10`，查表得到 `00`。

所以 S盒代换输出为 `1000`。

#### 步骤 4.4: **P4 置换**

将 `1000` 进行 P4 置换，结果为：

```
P4 置换结果：0001
```

#### 步骤 4.5: **与 L1 异或**

将 P4 置换结果与 L1 = `0011` 进行异或操作：

```
0001 XOR 0011 = 0010
```

得到 `L2 = 0010` 和 `R2 = 1100`。

### 5. **逆初始置换 (IP-1)**

将 `L2 = 0010` 和 `R2 = 1100` 合并为 `00101100`，进行逆初始置换。假设 IP-1 表如下：

```
IP-1: 4 1 3 5 7 2 8 6
```

将 `00101100` 置换后，得到密文：

```
密文：10100100
```

### 总结

通过上述步骤，我们使用密钥 `1010000010` 和明文 `10101010`，经过两轮加密，最终得到密文为 `10100100`。